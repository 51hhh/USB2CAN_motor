# GM3508 å’Œ GM6020 ç»Ÿä¸€æ¥å£è¯´æ˜

## âœ… å·²å®Œæˆçš„æ”¹è¿›

### 1. è§’åº¦å½’ä¸€åŒ–ï¼ˆ0-360Â°ï¼‰

**é—®é¢˜**ï¼šGM3508 çš„è§’åº¦ä¼šç´¯åŠ è¶…è¿‡ 360Â°ï¼ˆå¦‚ 675 åœˆ Ã— 360Â° = 243,000Â°ï¼‰

**è§£å†³æ–¹æ¡ˆ**ï¼šä½¿ç”¨æ¨¡è¿ç®—å½’ä¸€åŒ–åˆ° 0-360Â° èŒƒå›´

```cpp
double getAngleDegrees() const {
    // è·å–è¾“å‡ºè½´ä½ç½®ï¼ˆå¼§åº¦ï¼‰
    double output_rad = getOutputPosition();
    
    // è½¬æ¢ä¸ºåº¦
    double degrees = output_rad * 180.0 / M_PI;
    
    // å½’ä¸€åŒ–åˆ° [0, 360) èŒƒå›´
    degrees = fmod(degrees, 360.0);
    if (degrees < 0) degrees += 360.0;
    
    return degrees;
}
```

**æ•ˆæœ**ï¼š
- GM6020 å’Œ GM3508 éƒ½è¿”å› **0-360Â°** çš„è§’åº¦
- ç›‘æ§ç•Œé¢æ˜¾ç¤ºç»Ÿä¸€çš„è§’åº¦èŒƒå›´
- PID æ§åˆ¶ä½¿ç”¨ç»Ÿä¸€çš„è§’åº¦å•ä½

### 2. ç»Ÿä¸€æ§åˆ¶æ¥å£

**GM6020 å’Œ GM3508 ç°åœ¨å®Œå…¨ä¸€è‡´**ï¼š

| åŠŸèƒ½ | GM6020 | GM3508 | ç»Ÿä¸€ |
|------|--------|--------|------|
| è§’åº¦èŒƒå›´ | 0-360Â° | 0-360Â° | âœ… |
| ä½ç½®æ§åˆ¶ | âœ… | âœ… | âœ… |
| é€Ÿåº¦æ§åˆ¶ | âœ… | âœ… | âœ… |
| ç›´æ¥è¾“å‡º | âœ… | âœ… | âœ… |
| PID å‚æ•° | âœ… | âœ… | âœ… |
| ROS å‘½ä»¤ | âœ… | âœ… | âœ… |

### 3. å†…éƒ¨å®ç°å·®å¼‚ï¼ˆå¯¹ç”¨æˆ·é€æ˜ï¼‰

è™½ç„¶æ¥å£ç»Ÿä¸€ï¼Œä½†å†…éƒ¨å®ç°ä¸åŒï¼š

**GM6020**ï¼š
- ç¼–ç å™¨åœ¨è¾“å‡ºè½´
- ç›´æ¥è¯»å–è¾“å‡ºè½´è§’åº¦ï¼ˆ0-8191 â†’ 0-360Â°ï¼‰
- ä¸éœ€è¦ç´¯ç§¯åœˆæ•°

**GM3508**ï¼š
- ç¼–ç å™¨åœ¨ç”µæœºè½´ï¼ˆå‡é€Ÿå‰ï¼‰
- ç´¯ç§¯ç”µæœºè½´åœˆæ•°
- é™¤ä»¥å‡é€Ÿæ¯” 19 å¾—åˆ°è¾“å‡ºè½´ä½ç½®
- å½’ä¸€åŒ–åˆ° 0-360Â°

## ğŸ“Š è§’åº¦æ˜¾ç¤ºå¯¹æ¯”

### ä¿®æ”¹å‰ï¼ˆé”™è¯¯ï¼‰
```
[DJI DJI3508_2] Angle=296.6Â° RPM=1630 Rounds=675 Temp=19Â°C
                      ^^^^^^
                      ç´¯ç§¯è§’åº¦ï¼Œä¼šä¸€ç›´å¢é•¿
```

### ä¿®æ”¹åï¼ˆæ­£ç¡®ï¼‰
```
[DJI DJI3508_2] Angle=296.6Â° RPM=1630 Rounds=675 Temp=19Â°C
                      ^^^^^^
                      å½’ä¸€åŒ–è§’åº¦ï¼ˆ0-360Â°ï¼‰ï¼Œä¸ GM6020 ä¸€è‡´
```

**è¯´æ˜**ï¼š
- `Angle=296.6Â°`ï¼šè¾“å‡ºè½´çš„å½’ä¸€åŒ–è§’åº¦ï¼ˆ0-360Â°ï¼‰
- `Rounds=675`ï¼šç”µæœºè½´ç´¯ç§¯åœˆæ•°ï¼ˆä»…ç”¨äºè°ƒè¯•ï¼Œä¸å½±å“æ§åˆ¶ï¼‰

## ğŸ® ç»Ÿä¸€çš„ ROS æ§åˆ¶å‘½ä»¤

### 1. ç›´æ¥è¾“å‡ºæ§åˆ¶ï¼ˆåŸºç¡€å‘½ä»¤ï¼‰

**GM6020 å’Œ GM3508 ä½¿ç”¨ç›¸åŒçš„å‘½ä»¤**ï¼š

```bash
# GM6020 ç”µå‹æ§åˆ¶ï¼ˆ-30000 ~ 30000ï¼‰
ros2 topic pub --once /dji_motor_command motor_control_ros2/msg/DJIMotorCommand \
  '{joint_name: "DJI6020_1", output: 5000}'

# GM3508 ç”µæµæ§åˆ¶ï¼ˆ-16384 ~ 16384ï¼‰
ros2 topic pub --once /dji_motor_command motor_control_ros2/msg/DJIMotorCommand \
  '{joint_name: "DJI3508_2", output: 2000}'
```

### 2. ä½ç½®æ§åˆ¶ï¼ˆé«˜çº§å‘½ä»¤ï¼‰

**ç»Ÿä¸€ä½¿ç”¨ 0-360Â° è§’åº¦**ï¼š

```bash
# GM6020 ä½ç½®æ§åˆ¶ï¼šç§»åŠ¨åˆ° 90Â°
ros2 topic pub --once /dji_motor_command_advanced motor_control_ros2/msg/DJIMotorCommandAdvanced \
  '{joint_name: "DJI6020_1", mode: 2, position_target: 90.0}'

# GM3508 ä½ç½®æ§åˆ¶ï¼šç§»åŠ¨åˆ° 90Â°ï¼ˆå®Œå…¨ç›¸åŒçš„å‘½ä»¤æ ¼å¼ï¼‰
ros2 topic pub --once /dji_motor_command_advanced motor_control_ros2/msg/DJIMotorCommandAdvanced \
  '{joint_name: "DJI3508_2", mode: 2, position_target: 90.0}'
```

### 3. é€Ÿåº¦æ§åˆ¶ï¼ˆé«˜çº§å‘½ä»¤ï¼‰

**ç»Ÿä¸€ä½¿ç”¨ RPM å•ä½**ï¼š

```bash
# GM6020 é€Ÿåº¦æ§åˆ¶ï¼š50 RPM
ros2 topic pub --once /dji_motor_command_advanced motor_control_ros2/msg/DJIMotorCommandAdvanced \
  '{joint_name: "DJI6020_1", mode: 1, velocity_target: 50.0}'

# GM3508 é€Ÿåº¦æ§åˆ¶ï¼š50 RPMï¼ˆå®Œå…¨ç›¸åŒçš„å‘½ä»¤æ ¼å¼ï¼‰
ros2 topic pub --once /dji_motor_command_advanced motor_control_ros2/msg/DJIMotorCommandAdvanced \
  '{joint_name: "DJI3508_2", mode: 1, velocity_target: 50.0}'
```

## ğŸ”§ PID å‚æ•°é…ç½®

### ç»Ÿä¸€çš„é…ç½®æ ¼å¼

**GM6020 å’Œ GM3508 ä½¿ç”¨ç›¸åŒçš„é…ç½®ç»“æ„**ï¼ˆ`config/pid_params.yaml`ï¼‰ï¼š

```yaml
dji_motors:
  # GM6020 é…ç½®
  GM6020:
    position_pid:
      kp: 10.0
      ki: 1.0
      kd: 0.0
      i_max: 50.0
      out_max: 200.0     # æœ€å¤§é€Ÿåº¦ç›®æ ‡ï¼ˆRPMï¼‰
      dead_zone: 2.0     # ä½ç½®æ­»åŒºï¼ˆåº¦ï¼‰
    
    velocity_pid:
      kp: 40.0
      ki: 2.0
      kd: 0.1
      i_max: 1000.0
      out_max: 5000.0    # æœ€å¤§ç”µå‹
      dead_zone: 5.0     # é€Ÿåº¦æ­»åŒºï¼ˆRPMï¼‰
  
  # GM3508 é…ç½®ï¼ˆæ ¼å¼å®Œå…¨ç›¸åŒï¼‰
  GM3508:
    position_pid:
      kp: 10.0
      ki: 0.5
      kd: 0.0
      i_max: 10.0
      out_max: 300.0     # æœ€å¤§é€Ÿåº¦ç›®æ ‡ï¼ˆRPMï¼‰
      dead_zone: 0.5     # ä½ç½®æ­»åŒºï¼ˆåº¦ï¼‰
    
    velocity_pid:
      kp: 20.0
      ki: 0.5
      kd: 0.0
      i_max: 500.0
      out_max: 16384.0   # æœ€å¤§ç”µæµ
      dead_zone: 5.0     # é€Ÿåº¦æ­»åŒºï¼ˆRPMï¼‰
```

### å•ä½è¯´æ˜

| å‚æ•° | å•ä½ | GM6020 | GM3508 | è¯´æ˜ |
|------|------|--------|--------|------|
| ä½ç½®ç›®æ ‡ | åº¦ (Â°) | 0-360 | 0-360 | ç»Ÿä¸€ |
| é€Ÿåº¦ç›®æ ‡ | RPM | ç”µæœºè½´ | ç”µæœºè½´ | ç»Ÿä¸€ |
| ä½ç½®ç¯è¾“å‡º | RPM | é€Ÿåº¦ç›®æ ‡ | é€Ÿåº¦ç›®æ ‡ | ç»Ÿä¸€ |
| é€Ÿåº¦ç¯è¾“å‡º | - | ç”µå‹ | ç”µæµ | ä¸åŒ |
| out_max | - | 30000 | 16384 | ä¸åŒ |

## ğŸ“ˆ ç›‘æ§ç•Œé¢æ˜¾ç¤º

### ç»Ÿä¸€çš„æ˜¾ç¤ºæ ¼å¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åç§°        â”‚ å‹å·   â”‚ çŠ¶æ€   â”‚ è§’åº¦(Â°) â”‚ æ¸©åº¦ â”‚ é¢‘ç‡   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ DJI6020_1   â”‚ GM6020 â”‚ åœ¨çº¿   â”‚   262.8 â”‚  21Â°Câ”‚  200Hz â”‚
â”‚ DJI3508_2   â”‚ GM3508 â”‚ åœ¨çº¿   â”‚   296.6 â”‚  19Â°Câ”‚  200Hz â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  ^^^^^^^   ^^^^^^^
                                  éƒ½æ˜¯ 0-360Â° èŒƒå›´
```

**ç‰¹ç‚¹**ï¼š
- ä¸¤ç§ç”µæœºçš„è§’åº¦éƒ½æ˜¾ç¤ºåœ¨ 0-360Â° èŒƒå›´å†…
- ç”¨æˆ·æ— éœ€å…³å¿ƒå†…éƒ¨å®ç°å·®å¼‚
- å®Œå…¨ç»Ÿä¸€çš„ç”¨æˆ·ä½“éªŒ

## ğŸ§ª æµ‹è¯•éªŒè¯

### æµ‹è¯• 1: è§’åº¦å½’ä¸€åŒ–

```bash
# é‡å¯æ§åˆ¶èŠ‚ç‚¹
source install/setup.bash
ros2 run motor_control_ros2 motor_control_node

# æ‰‹åŠ¨æ—‹è½¬ GM3508 è¾“å‡ºè½´å¤šåœˆ
# è§‚å¯Ÿæ—¥å¿—ï¼šè§’åº¦åº”è¯¥åœ¨ 0-360Â° å¾ªç¯ï¼ŒRounds ä¼šå¢åŠ 

# é¢„æœŸè¾“å‡ºï¼š
# [DJI DJI3508_2] Angle=45.0Â° RPM=0 Rounds=2 Temp=20Â°C
# [DJI DJI3508_2] Angle=90.0Â° RPM=0 Rounds=5 Temp=20Â°C
# [DJI DJI3508_2] Angle=180.0Â° RPM=0 Rounds=9 Temp=20Â°C
# [DJI DJI3508_2] Angle=270.0Â° RPM=0 Rounds=14 Temp=21Â°C
# [DJI DJI3508_2] Angle=0.0Â° RPM=0 Rounds=19 Temp=21Â°C   â† å½’ä¸€åŒ–åˆ° 0Â°
# [DJI DJI3508_2] Angle=45.0Â° RPM=0 Rounds=21 Temp=21Â°C
```

### æµ‹è¯• 2: ä½ç½®æ§åˆ¶ï¼ˆè§’åº¦è¿‡é›¶ï¼‰

```bash
# GM3508 ä» 10Â° åˆ° 350Â°ï¼ˆåº”è¯¥é€†æ—¶é’ˆ -20Â°ï¼‰
ros2 topic pub --once /dji_motor_command_advanced motor_control_ros2/msg/DJIMotorCommandAdvanced \
  '{joint_name: "DJI3508_2", mode: 2, position_target: 10.0}'

sleep 3

ros2 topic pub --once /dji_motor_command_advanced motor_control_ros2/msg/DJIMotorCommandAdvanced \
  '{joint_name: "DJI3508_2", mode: 2, position_target: 350.0}'

# è§‚å¯Ÿï¼šç”µæœºåº”è¯¥é€†æ—¶é’ˆæ—‹è½¬çº¦ 20Â°ï¼ˆæœ€çŸ­è·¯å¾„ï¼‰
```

### æµ‹è¯• 3: é€Ÿåº¦æ§åˆ¶

```bash
# GM3508 é€Ÿåº¦æ§åˆ¶ï¼š100 RPM
ros2 topic pub --once /dji_motor_command_advanced motor_control_ros2/msg/DJIMotorCommandAdvanced \
  '{joint_name: "DJI3508_2", mode: 1, velocity_target: 100.0}'

# è§‚å¯Ÿï¼šç”µæœºåº”è¯¥ä»¥æ’å®šé€Ÿåº¦æ—‹è½¬
# ç›‘æ§æ˜¾ç¤ºè§’åº¦åº”è¯¥æŒç»­å˜åŒ–ï¼ˆ0-360Â° å¾ªç¯ï¼‰
```

## ğŸ“ å…³é”®æ”¹è¿›æ€»ç»“

### âœ… è§’åº¦ç»Ÿä¸€
- **GM6020**ï¼š0-360Â°ï¼ˆç¼–ç å™¨ç›´æ¥è¯»å–ï¼‰
- **GM3508**ï¼š0-360Â°ï¼ˆç´¯ç§¯ç¼–ç å™¨ / 19ï¼Œå½’ä¸€åŒ–ï¼‰
- **ç›‘æ§æ˜¾ç¤º**ï¼šç»Ÿä¸€ 0-360Â°
- **PID æ§åˆ¶**ï¼šç»Ÿä¸€ 0-360Â°
- **ROS æ¶ˆæ¯**ï¼šç»Ÿä¸€ 0-360Â°

### âœ… æ§åˆ¶ç»Ÿä¸€
- **ä½ç½®æ§åˆ¶**ï¼šä¸¤ç§ç”µæœºä½¿ç”¨ç›¸åŒçš„å‘½ä»¤å’Œå‚æ•°
- **é€Ÿåº¦æ§åˆ¶**ï¼šä¸¤ç§ç”µæœºä½¿ç”¨ç›¸åŒçš„å‘½ä»¤å’Œå‚æ•°
- **ç›´æ¥è¾“å‡º**ï¼šä¸¤ç§ç”µæœºä½¿ç”¨ç›¸åŒçš„å‘½ä»¤æ ¼å¼

### âœ… PID ç»Ÿä¸€
- **é…ç½®æ ¼å¼**ï¼šå®Œå…¨ç›¸åŒçš„ YAML ç»“æ„
- **å‚æ•°å•ä½**ï¼šä½ç½®ï¼ˆåº¦ï¼‰ã€é€Ÿåº¦ï¼ˆRPMï¼‰ç»Ÿä¸€
- **æ§åˆ¶é€»è¾‘**ï¼šä¸²çº§ PID + è§’åº¦è¿‡é›¶å¤„ç†

### ğŸ” å†…éƒ¨å·®å¼‚ï¼ˆå¯¹ç”¨æˆ·é€æ˜ï¼‰
- GM6020ï¼šç¼–ç å™¨åœ¨è¾“å‡ºè½´ï¼Œç›´æ¥è¯»å–
- GM3508ï¼šç¼–ç å™¨åœ¨ç”µæœºè½´ï¼Œç´¯ç§¯ + å‡é€Ÿæ¯”è½¬æ¢
- ç”¨æˆ·æ— éœ€å…³å¿ƒè¿™äº›å·®å¼‚ï¼Œæ¥å£å®Œå…¨ç»Ÿä¸€

## ğŸ¯ ä½¿ç”¨å»ºè®®

1. **ä½ç½®æ§åˆ¶**ï¼šä½¿ç”¨ 0-360Â° è§’åº¦ï¼Œç³»ç»Ÿè‡ªåŠ¨å¤„ç†æœ€çŸ­è·¯å¾„
2. **é€Ÿåº¦æ§åˆ¶**ï¼šä½¿ç”¨ RPM å•ä½ï¼Œä¸¤ç§ç”µæœºå“åº”ä¸€è‡´
3. **PID è°ƒè¯•**ï¼šä»å°çš„ kp å¼€å§‹ï¼Œé€æ­¥å¢åŠ 
4. **ç›‘æ§è§‚å¯Ÿ**ï¼šè§’åº¦å§‹ç»ˆåœ¨ 0-360Â° èŒƒå›´å†…å¾ªç¯

ç°åœ¨ GM3508 å’Œ GM6020 å·²ç»å®Œå…¨ç»Ÿä¸€ï¼Œå¯ä»¥åƒä½¿ç”¨åŒä¸€ç§ç”µæœºä¸€æ ·ä½¿ç”¨å®ƒä»¬ï¼ğŸ‰
